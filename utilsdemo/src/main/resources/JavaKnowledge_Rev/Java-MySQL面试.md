# MySQL
## 问：MySQL 事物隔离级别有哪些？
## 答：
> 读未提交：这个隔离级别下会产生脏读、不可重复读、幻读；   
> 读已提交：这个隔离级别下会产生不可重复读、幻读的问题；  
> 可重复读：这个隔离级别下会产生幻读的问题；  
> 可串行化：不会产生任何问题；
## 问：了解 MVCC 吗，谈谈你对 MVCC 的理解
## 答：
> MySQL 是通过 MVCC(Multi-Version Concurrency Control) 来实现事务的隔离性的。通过这种机制避免了频繁加锁互斥，提高了 MySQL 读写的效率。 MySQL 事务在读已提交和可重复读隔离级别下实现了 MVCC 机制。  

## 问：那么 MVCC 是怎么实现的呢？
## 答：
> MVCC 在 InnodB 底层实现是通过隐藏字段、Undo-log日志、ReadView这三个东西实现的。  
> 隐藏字段比较重要的字段：最近更新的事务ID - TRX_ID  
> undo日志版本链是指一行数据被多个事务依次修改过后，在每个事务修改完后，Mysql 会保留修改前的数据 undo 回滚 日志，并且用两个隐藏字段 trx_id 和 roll_pointer 把这些 undo 日志串联起来形成一个历史记录版本链。  
> 执行查询 sql 的时候会生成当前事务的一致性视图 read-view。  
---
> 整个版本链的比较规则是：  
> 如果 row 的 trx_id<min_id(最小事物id)，表示这个版本是已提交的事务生成的，这个数据是可见的;  
> 如果 row 的 trx_id>max_id(最大事物id)，表示这个版本是由将来启动的事务生成的，是不可见的;  
> 如果 row 的 min_id <=trx_id<= max_id，表示这个版本是由还没提交的事务生成的，不可见(若 row 的 trx_id 就是当前自己的事务，那么此时是可见的);  
> 若 row 的 trx_id 不在视图数组中，表示这个版本是已经提交了的事务生成的，可见；

