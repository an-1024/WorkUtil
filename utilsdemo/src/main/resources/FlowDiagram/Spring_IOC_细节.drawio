<mxfile host="app.diagrams.net" modified="2022-08-22T13:00:57.129Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36" etag="kxJooaVM5gYwN1nmWbFv" version="20.2.5" type="github">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="8647" dy="2272" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="-McDBByZdcgpEU9wJOO_-78" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Verdana;fontSize=18;fontColor=#00CCCC;strokeColor=#00CCCC;fillColor=#00CCCC;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-310" y="-1100" width="620" height="550" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-72" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-0" target="vhB5iVHmFAJZdGOzhbKn-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-0" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;Spring IOC 细节-&amp;gt; XML的bean加载&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-153" y="-1010" width="306" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-5" target="vhB5iVHmFAJZdGOzhbKn-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-5" value="ClassPathXmlApplicationContext(&quot;classpath:spring-config.xml&quot;)&lt;br style=&quot;font-size: 18px;&quot;&gt;指定加载文件位置" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-268" y="-920" width="536" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-8" target="vhB5iVHmFAJZdGOzhbKn-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF3333;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-8" target="-McDBByZdcgpEU9wJOO_-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-8" value="super(parent); 父级的层层调用，初始化 Spring Factory的属性值" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-251.5" y="-840" width="503" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-10" target="vhB5iVHmFAJZdGOzhbKn-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-10" target="vhB5iVHmFAJZdGOzhbKn-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-10" value="&lt;font color=&quot;#ff3333&quot; style=&quot;font-size: 18px;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;validating = true // XML 文档是否需要校验&lt;/b&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;align=left;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="350" y="-825" width="370" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-12" target="vhB5iVHmFAJZdGOzhbKn-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-12" value="&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff3333&quot; style=&quot;font-size: 18px;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;String[] configLocations 配置文件路径&lt;/b&gt;&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;setIdCalled = false 是否重新设置 bean 名称 ：fasle表示可以， true 表示不能自定义&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;align=left;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="810" y="-830" width="772.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="vhB5iVHmFAJZdGOzhbKn-15" target="vhB5iVHmFAJZdGOzhbKn-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-15" value="&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;Boolean allowBeanDefinitionOverriding是否允许 beanDefinition 定义被覆盖&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;Boolean allowCircularReferences 允许循环引用&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;DefaultListableBeanFactory beanFactory ：beanFactory 工厂定义&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;align=left;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="2018.13" y="-845" width="803.75" height="70" as="geometry" />
        </mxCell>
        <mxCell id="vhB5iVHmFAJZdGOzhbKn-18" value="&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;String MESSAGE_SOURCE_BEAN_NAME = &quot;messageSource&quot; 消息解析器， 未指定加载父类的消息解析器&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;String LIFECYCLE_PROCESSOR_BEAN_NAME = &quot;lifecycleProcessor&quot; 生命周期处理器，为提供默认使用DefaultLifecycleProcessor&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;String APPLICATION_EVENT_MULTICASTER_BEAN_NAME = &quot;applicationEventMulticaster&quot; 应用事件广播，未指定默认使用SimpleApplicationEventMulticaster&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;String id = ObjectUtils.identityToString(this) 应用id 赋值&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;String displayName = ObjectUtils.identityToString(this) 显示名称赋值&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;ApplicationContext parent 父类上下文&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff3333&quot; style=&quot;font-size: 18px;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;ConfigurableEnvironment environment 应用执行环境&amp;nbsp;&lt;/b&gt;&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final List&amp;lt;BeanFactoryPostProcessor&amp;gt; beanFactoryPostProcessors = new ArrayList&amp;lt;&amp;gt;() 实例化前置处理器集合&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;long startupDate 应用开始启动时间&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final AtomicBoolean active = new AtomicBoolean() 应用是否正在运行&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final AtomicBoolean closed = new AtomicBoolean() 应用是否已经关闭&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final Object startupShutdownMonitor = new Object() 刷新和销毁的同步监视器&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;Thread shutdownHook&amp;nbsp; 如果已经注册JVM钩子函数，那么该变量就是JVM 钩子函数的引用&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff3333&quot; style=&quot;font-size: 18px;&quot;&gt;ResourcePatternResolver resourcePatternResolver; 资源解析器 在&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;font color=&quot;#ff3333&quot; style=&quot;font-size: 18px;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;AbstractApplicationContext 构造函数中实现赋值&amp;nbsp;this.resourceLoader = resourceLoader(&lt;b style=&quot;font-size: 18px;&quot;&gt;AbstractApplicationContext&lt;/b&gt;)&lt;/b&gt;&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;LifecycleProcessor lifecycleProcessor; 生命周期处理器&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;MessageSource messageSource 国际化的实现&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;ApplicationEventMulticaster applicationEventMulticaster; 管理许多 {@link ApplicationListener} 对象并向它们发布事件的对象实现的接口。&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;final Set&amp;lt;ApplicationListener&amp;lt;?&amp;gt;&amp;gt; applicationListeners = new LinkedHashSet&amp;lt;&amp;gt;(); 应用程序实现的监听程序的接口&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;Set&amp;lt;ApplicationListener&amp;lt;?&amp;gt;&amp;gt; earlyApplicationListeners; 本地监听器的注册&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;Set&amp;lt;ApplicationEvent&amp;gt; earlyApplicationEvents 应用程序所有时间扩展类&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1618.28" y="-710" width="1603.44" height="460" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-0" target="-McDBByZdcgpEU9wJOO_-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-32" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-0" target="-McDBByZdcgpEU9wJOO_-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-0" value="设置&amp;nbsp;&lt;span style=&quot;text-align: left; font-size: 18px;&quot;&gt;&lt;font style=&quot;font-weight: bold; font-size: 18px;&quot; color=&quot;#ff3333&quot;&gt;configLocations 的值&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;div style=&quot;text-align: left; font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; text-align: center; font-size: 18px;&quot;&gt;setConfigLocations(configLocations)&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-157" y="-749.99" width="314" height="50" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-4" target="-McDBByZdcgpEU9wJOO_-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-0" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=18;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-4" target="-McDBByZdcgpEU9wJOO_-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-4" value="resolvePath(locations[i])&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#e06d0d&quot; style=&quot;font-size: 18px;&quot;&gt;getEnvironment() 获取当前系统环境变量 environment 变量在这里完成了赋值&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;getEnvironment().resolveRequiredPlaceholders(path) 创建资源加载器解析资源所在路径&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;align=left;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-1120" y="-776.25" width="780" height="102.5" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#E06D0D;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-6" target="-McDBByZdcgpEU9wJOO_-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-8" value="AbstractEnvironment&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final String IGNORE_GETENV_PROPERTY_NAME = &quot;spring.getenv.ignore&quot; 系统环境需要忽略的属性&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final String ACTIVE_PROFILES_PROPERTY_NAME = &quot;spring.profiles.active&quot;&amp;nbsp;设置以指定活动配置文件的属性名称&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final String RESERVED_DEFAULT_PROFILE_NAME = &quot;default&quot;;&amp;nbsp; &amp;nbsp;默认配置文件名称的名称&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;b style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ffff00&quot; style=&quot;font-size: 18px;&quot;&gt;final MutablePropertySources propertySources = new MutablePropertySources()&amp;nbsp; 属性配置类 -&amp;gt; 父类构造函数中调用了&amp;nbsp;customizePropertySources(this.propertySources) 来初始化该变量，具体实现子类的重写方法中(同样我们也可以指定 系统(System) 或者 JVM 需要加载的属性)&lt;/font&gt;&lt;/b&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#EF8707;strokeColor=#666666;fontColor=#333333;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-2235" y="-1080" width="1160" height="210" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-16" value="" style="group;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1" connectable="0">
          <mxGeometry x="-2140" y="-818.12" width="970" height="186.25" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-6" value="createEnvironment -&amp;gt; new StandardEnvironment()&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final String SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME = &quot;systemEnvironment&quot; 系统环境变量属性&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final String SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME = &quot;systemProperties&quot; JVM 环境变量属&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#EF8707;strokeColor=#666666;rounded=0;fontColor=#333333;horizontal=1;verticalAlign=top;fontSize=18;" parent="-McDBByZdcgpEU9wJOO_-16" vertex="1">
          <mxGeometry width="970.0000000000001" height="186.25000000000003" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-15" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 18px;&quot;&gt;customizePropertySources(MutablePropertySources propertySources)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FFFF00;strokeColor=#EF8707;fillColor=#FFFF00;align=left;" parent="-McDBByZdcgpEU9wJOO_-16" vertex="1">
          <mxGeometry x="14.923076923076925" y="128.94230769230774" width="940.1538461538462" height="42.98076923076923" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Verdana;fontSize=18;fontColor=#000000;exitX=0;exitY=0.582;exitDx=0;exitDy=0;exitPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-8" target="-McDBByZdcgpEU9wJOO_-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-26" value="doResolvePlaceholders(String text, PropertyPlaceholderHelper helper)实现对了资源路径的解析" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-950" y="-630" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-31" target="-McDBByZdcgpEU9wJOO_-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-39" value="&lt;div style=&quot;text-align: left; font-size: 18px;&quot;&gt;给 Spring&lt;/div&gt;一些基础属性&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;div style=&quot;text-align: left; font-size: 18px;&quot;&gt;赋值&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontFamily=Verdana;fontColor=#000000;" parent="-McDBByZdcgpEU9wJOO_-36" vertex="1" connectable="0">
          <mxGeometry x="0.007" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-31" value="refresh() 完成了 bean 的创建过程；以下流程是 refresh 细节" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-143" y="-650" width="286" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-38" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#000000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-35" target="-McDBByZdcgpEU9wJOO_-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-40" value="创建 BeanFactory 工厂" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontFamily=Verdana;fontColor=#000000;" parent="-McDBByZdcgpEU9wJOO_-38" vertex="1" connectable="0">
          <mxGeometry x="-0.3238" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-35" value="prepareRefresh&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;this.startupDate = System.currentTimeMillis() 启动时间赋值&lt;/span&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;this.closed.set(false);&amp;nbsp;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;this.active.set(true);&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;initPropertySources() 父类留给子类有关环境属性的扩展方法，父类没有实现具体逻辑&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;getEnvironment().validateRequiredProperties() 校验环境属性是否全部填充完成&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;earlyApplicationListeners、applicationListeners 在 Spring Boot 中会提前加载很多事件监听器(14 个)：逻辑是判断 earlyApplicationListeners 集合是否为 null，如果为 null 将 applicationListeners 集合赋值给 earlyApplicationListeners；反之，则将 applicationListeners 集合清空，将原有 earlyApplicationListeners 赋值给 applicationListeners (Spring Boot 中就是利用了这个逻辑)&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;align=left;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-1510" y="-370" width="3030" height="210" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Verdana;fontSize=18;fontColor=#FFFF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-37" target="-McDBByZdcgpEU9wJOO_-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-60" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#00FF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-37" target="-McDBByZdcgpEU9wJOO_-56" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-37" value="obtainFreshBeanFactory&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#e06d0d&quot; style=&quot;font-size: 18px;&quot;&gt;refreshBeanFactory(); 针对 beanFactory的一系例操作&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;getBeanFactory 获取创建成功的 BeanFactory&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-315" y="-35" width="630" height="115" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Verdana;fontSize=18;fontColor=#FFFF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-43" target="-McDBByZdcgpEU9wJOO_-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-43" value="refreshBeanFactory&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;存在 BeanFactory 就销毁&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ffff00&quot; style=&quot;font-size: 18px;&quot;&gt;创建 BeanFactory 工厂&amp;nbsp;DefaultListableBeanFactory beanFactory = createBeanFactory()&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#E06D0D;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="414" y="-30.620000000000005" width="799.37" height="106.25" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-51" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-47" target="-McDBByZdcgpEU9wJOO_-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-47" value="createBeanFactory&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;创建了一个DefaultListableBeanFactory对象，又是一层层的 super&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1290" y="-21.25" width="570" height="87.5" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-53" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-50" target="-McDBByZdcgpEU9wJOO_-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-50" value="DefaultListableBeanFactory&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;boolean allowBeanDefinitionOverriding = true&amp;nbsp;是否允许重新注册具有相同名称的不同定义&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;boolean allowEagerClassLoading = true&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;AutowireCandidateResolver autowireCandidateResolver = SimpleAutowireCandidateResolver.INSTANCE&amp;nbsp;用于检查 bean 定义是否为自动装配候选者的解析器&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final Map&amp;lt;Class&amp;lt;?&amp;gt;, Object&amp;gt; resolvableDependencies = new ConcurrentHashMap&amp;lt;&amp;gt;(16) 从依赖类型映射到相应的自动装配值&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final Map&amp;lt;String, BeanDefinition&amp;gt; beanDefinitionMap = new ConcurrentHashMap&amp;lt;&amp;gt;(256)&amp;nbsp;bean 定义对象的映射，以 bean 名称为键&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final Map&amp;lt;String, BeanDefinitionHolder&amp;gt; mergedBeanDefinitionHolders = new ConcurrentHashMap&amp;lt;&amp;gt;(256)&amp;nbsp;单例和非单例 bean 名称的映射，以依赖类型为键。&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final Map&amp;lt;Class&amp;lt;?&amp;gt;, String[]&amp;gt; singletonBeanNamesByType = new ConcurrentHashMap&amp;lt;&amp;gt;(64) 仅单例 bean 名称的映射，以依赖类型为键&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;volatile Set&amp;lt;String&amp;gt; manualSingletonNames = new LinkedHashSet&amp;lt;&amp;gt;(16);&amp;nbsp; 按照顺序手动注册单例 bean 的集合&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1980" y="-180" width="780" height="405" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-55" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#00FF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-52" target="-McDBByZdcgpEU9wJOO_-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-52" value="AbstractAutowireCapableBeanFactory&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;InstantiationStrategy instantiationStrategy = new CglibSubclassingInstantiationStrategy() bea 实例化策略&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;ParameterNameDiscoverer parameterNameDiscoverer = new DefaultParameterNameDiscoverer() 方法参数名称的解析策略&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;boolean allowCircularReferences = true; 是否尝试自动解决循环依赖&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;boolean allowRawInjectionDespiteWrapping = false 是否在循环依赖的情况下注入 bean&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final Set&amp;lt;Class&amp;lt;?&amp;gt;&amp;gt; ignoredDependencyTypes = new HashSet&amp;lt;&amp;gt;() 自动装配需要忽略的类型，如字符串等，默认为 null&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#00ff00&quot; style=&quot;font-size: 18px;&quot;&gt;final Set&amp;lt;Class&amp;lt;?&amp;gt;&amp;gt; ignoredDependencyInterfaces = new HashSet&amp;lt;&amp;gt;();&amp;nbsp;在依赖检查和自动装配时忽略依赖接口，作为类对象集。默认情况下，仅忽略 BeanFactory 接口。&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final NamedThreadLocal&amp;lt;String&amp;gt; currentlyCreatedBean = new NamedThreadLocal&amp;lt;&amp;gt;(&quot;Currently created bean&quot;)当前创建的 bean 的名称，用于对 getBean 等调用的隐式依赖注册，这些调用由用户指定的供应商回调触发&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final ConcurrentMap&amp;lt;String, BeanWrapper&amp;gt; factoryBeanInstanceCache = new ConcurrentHashMap&amp;lt;&amp;gt;()&amp;nbsp;未完成 FactoryBean 实例的缓存&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final ConcurrentMap&amp;lt;Class&amp;lt;?&amp;gt;, Method[]&amp;gt; factoryMethodCandidateCache = new ConcurrentHashMap&amp;lt;&amp;gt;()&amp;nbsp;每个工厂类的候选工厂方法缓存&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;final ConcurrentMap&amp;lt;Class&amp;lt;?&amp;gt;, PropertyDescriptor[]&amp;gt; filteredPropertyDescriptorsCache 过滤后的 PropertyDescriptor 缓存：bean 类到 PropertyDescriptor 数组&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1470.6200000000001" y="310" width="1798.75" height="285" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-54" value="AbstractAutowireCapableBeanFactory：构造函数执行 -&amp;gt; 忽略依赖接口&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;ignoreDependencyInterface(BeanNameAware.class);&lt;/span&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;  &lt;/span&gt;ignoreDependencyInterface(BeanFactoryAware.class);&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;  &lt;/span&gt;ignoreDependencyInterface(BeanClassLoaderAware.class);&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#00FF00;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="2075" y="682.5" width="590" height="147.5" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-62" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#00FF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-56" target="-McDBByZdcgpEU9wJOO_-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-56" value="customizeBeanFactory 看到这个有没有觉得熟悉：类似前面提到系统环境属性的扩展点: 定义&amp;nbsp; beanFactory 的 bean 的属性：&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;allowBeanDefinitionOverriding&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;allowCircularReferences&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-502" y="170" width="1004" height="130" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-61" target="-McDBByZdcgpEU9wJOO_-75">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-61" target="-McDBByZdcgpEU9wJOO_-81">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-61" target="-McDBByZdcgpEU9wJOO_-63">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-61" target="-McDBByZdcgpEU9wJOO_-65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-61" value="&lt;font color=&quot;#ea6b66&quot; style=&quot;font-size: 18px;&quot;&gt;loadBeanDefinitions(beanFactory)：加载 XML(一系列的重载调用) 读取 bean 信息并解析&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#cc6600&quot; style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;使用适配器模式将 beanFactory 转为转&amp;nbsp;&lt;/font&gt;XmlBeanDefinitionReader XML 解析器&amp;nbsp;XmlBeanDefinitionReader beanDefinitionReader = new XmlBeanDefinitionReader(beanFactory);&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;设置 XML 解析器需要的运行环境&amp;nbsp;beanDefinitionReader.setEnvironment(this.getEnvironment());&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;设置资源加载器&amp;nbsp;beanDefinitionReader.setResourceLoader(this);&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;设置用于解析 SAX 实体解析器，默认使用&amp;nbsp;ResourceEntityResolver 解析器。可以自定义实体解析覆盖，例如相对于某些特定的基本路径&amp;nbsp;beanDefinitionReader.setEntityResolver(new ResourceEntityResolver(this));&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#00cccc&quot; style=&quot;font-size: 18px;&quot;&gt;初始化解析器属性：initBeanDefinitionReader(beanDefinitionReader);&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ffff00&quot; style=&quot;font-size: 18px;&quot;&gt;重载&amp;nbsp;loadBeanDefinitions(beanDefinitionReader);&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-754.0400000000001" y="440" width="1508.08" height="230" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#CC6600;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-63" target="swjzN8IUrycUAb-GRa1w-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-63" value="创建&amp;nbsp;XmlBeanDefinitionReader 对象&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final int VALIDATION_NONE = XmlValidationModeDetector.VALIDATION_NONE -&amp;gt; 0;&amp;nbsp; 禁用验证&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final int VALIDATION_AUTO = XmlValidationModeDetector.VALIDATION_AUTO; -&amp;gt; 1 表示应自动检测验证模式。&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final int VALIDATION_DTD = XmlValidationModeDetector.VALIDATION_DTD; -&amp;gt; 2 表示 DTD 格式&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final int VALIDATION_XSD = XmlValidationModeDetector.VALIDATION_XSD; -&amp;gt; 3 表示 XSD 格式&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;supper()&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#E06D0D;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-1820" y="110" width="970" height="225" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-68" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FFFF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-65" target="-McDBByZdcgpEU9wJOO_-67" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-65" value="ResourceEntityResolver&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ffff00&quot; style=&quot;font-size: 18px;&quot;&gt;super(resourceLoader.getClassLoader());&amp;nbsp;&amp;nbsp;调用父类方法获取对应的解析器 DTD or XSD&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-1615" y="880" width="765" height="90" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-74" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#00CCCC;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-67" target="-McDBByZdcgpEU9wJOO_-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-67" target="-McDBByZdcgpEU9wJOO_-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-67" value="DelegatingEntityResolver&lt;br style=&quot;font-size: 18px;&quot;&gt;static final String DTD_SUFFIX = &quot;.dtd&quot;;&lt;br style=&quot;font-size: 18px;&quot;&gt;static final String XSD_SUFFIX = &quot;.xsd&quot;;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;this.dtdResolver = new BeansDtdResolver();&amp;nbsp; &amp;nbsp;创建 DTD 解析器&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#00cccc&quot; style=&quot;font-size: 18px;&quot;&gt;new PluggableSchemaResolver(classLoader) XSD 解析器 -&amp;gt; &quot;META-INF/spring.schemas&quot;&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-1622.5" y="1050" width="780" height="180" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-69" value="BeansDtdResolver&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final String DTD_EXTENSION = &quot;.dtd&quot;;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final String DTD_NAME = &quot;spring-beans&quot;;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-754.04" y="980" width="450" height="120" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-73" value="PluggableSchemaResolver XSD 文件路径映射&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;static final String DEFAULT_SCHEMA_MAPPINGS_LOCATION = &quot;META-INF/spring.schemas&quot;;定义架构映射的文件的位置。可以存在于多个 JAR 文件中&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;volatile Map&amp;lt;String, String&amp;gt; schemaMappings 资源路径映射&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;注意这里调试的时候&amp;nbsp;schemaMappings 发现被赋值了，这其实是 IDEA 自己调用了&amp;nbsp;PluggableSchemaResolver toString 方法，而 toString 方法中又包含了&amp;nbsp;getSchemaMappings() 导致这个 Map 被赋值。&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#00CCCC;strokeColor=#82b366;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-754.04" y="1160" width="1635" height="165" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-75" value="设置解析方式:&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;this.validationMode = 1 表示应自动检测验证模式&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;this.namespaceAware&lt;b style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp;&lt;/b&gt;= false&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#00CCCC;strokeColor=#00CCCC;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-1490" y="500" width="460" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-80" value="&lt;font style=&quot;font-size: 18px;&quot; color=&quot;#000000&quot;&gt;主流程&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Verdana;fontSize=18;fontColor=#00CCCC;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-184" y="-1070" width="196" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-84" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-81" target="-McDBByZdcgpEU9wJOO_-83" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-81" target="-McDBByZdcgpEU9wJOO_-85">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-14" value="String[] -&amp;gt; String" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=18;" vertex="1" connectable="0" parent="swjzN8IUrycUAb-GRa1w-13">
          <mxGeometry x="0.2091" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-81" value="loadBeanDefinitions(XmlBeanDefinitionReader reader)：两种获取文件资源路径&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;以 Resource 方式获取&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;以 String 的形式获取&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#00cccc&quot; style=&quot;font-size: 18px;&quot;&gt;重载&amp;nbsp;reader.loadBeanDefinitions(configLocations)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-1730" y="682.5" width="880" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-83" value="String[] configLocations = getConfigLocations()：&lt;br style=&quot;font-size: 18px;&quot;&gt;看到这个 getConfigLocations 应该很熟悉了吧，在设置配置文件路径的时候赋的值" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#FF0000;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-2510" y="800" width="680" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-92" value="&lt;span style=&quot;color: rgb(0, 0, 0); font-size: 18px;&quot;&gt;&amp;nbsp;String -&amp;gt; Resource[]&lt;/span&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-85" target="-McDBByZdcgpEU9wJOO_-91" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-1839.0000000000005" y="329.6199999999999" as="sourcePoint" />
            <mxPoint x="-2050.0000000000005" y="329.69692307692276" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-85" value="loadBeanDefinitions(String... locations)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;重载&amp;nbsp;loadBeanDefinitions(location)-&amp;gt;&amp;nbsp;loadBeanDefinitions(location, null)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#00CCCC;strokeColor=#00CCCC;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-2450" y="540" width="620" height="85" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-94" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FFFF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-91" target="-McDBByZdcgpEU9wJOO_-93" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-98" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#00CCCC;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-91" target="-McDBByZdcgpEU9wJOO_-97" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-91" value="loadBeanDefinitions(String location, @Nullable Set&amp;lt;Resource&amp;gt; actualResources)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;在最开始的 supper 中完成了父类&amp;nbsp;ResourcePatternResolver 变量&amp;nbsp;this.resourceLoader = resourceLoader(AbstractApplicationContext) 赋值&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ffff00&quot; style=&quot;font-size: 18px;&quot;&gt;Resource[] resources = ((ResourcePatternResolver) resourceLoader).getResources(location)&amp;nbsp;获取具体资源解析器的定位 ResourcePatternResolver 有多个实现&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#00cccc&quot; style=&quot;font-size: 18px;&quot;&gt;重载 loadBeanDefinitions(resources)&amp;nbsp;&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#FF0000;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-4410" y="515" width="1580" height="138.5" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-93" value="getResources(String locationPattern)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;String CLASSPATH_ALL_URL_PREFIX = &quot;classpath*:&quot;&amp;nbsp; 资源文件属性是否以 classpath* 开始&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;或者以 war: 开始&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;都不是将 location 封装成一个 Resource[] 对象&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-4570" y="730" width="800" height="130" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-19" value="&lt;font color=&quot;#000000&quot;&gt;Resources[] -&amp;gt; Resources&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#CC6600;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-97" target="-McDBByZdcgpEU9wJOO_-99">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-97" value="loadBeanDefinitions(Resource... resources)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;for 循环处理 resources&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#00CCCC;strokeColor=#00CCCC;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-3220" y="730" width="360" height="98.75" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-102" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-99" target="-McDBByZdcgpEU9wJOO_-101" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-103" value="&lt;span style=&quot;font-family: Helvetica; font-size: 18px; text-align: left; background-color: rgb(248, 249, 250);&quot;&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontFamily=Verdana;fontColor=#000000;" parent="-McDBByZdcgpEU9wJOO_-102" vertex="1" connectable="0">
          <mxGeometry x="0.3588" relative="1" as="geometry">
            <mxPoint x="15" y="120" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-105" value="Resource -&amp;gt; EncodeResource" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontFamily=Verdana;fontColor=#000000;" parent="-McDBByZdcgpEU9wJOO_-102" vertex="1" connectable="0">
          <mxGeometry x="-0.0664" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-99" value="loadBeanDefinitions(Resource resource)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;将 resource 封装为 encodedResource，该类实现了 InputStreamSource 并设置解析编码格式，这里什么都没有做，传的都是 null&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;继续重载调用&amp;nbsp;loadBeanDefinitions(EncodedResource encodedResource)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#00CCCC;strokeColor=#00CCCC;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-3580" y="930" width="1080" height="120" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-107" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 18px;&quot;&gt;inputSource -&amp;gt; Document&lt;/font&gt;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FFFF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-101" target="-McDBByZdcgpEU9wJOO_-106" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-101" value="loadBeanDefinitions(EncodedResource encodedResource)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;Set&amp;lt;EncodedResource&amp;gt; currentResources = this.resourcesCurrentlyBeingLoaded.get() 获取已经加载的 encodedResource&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;将 encodedResource 转换为输入流&amp;nbsp;InputStream inputStream = encodedResource.getResource().getInputStream()，使用InputSource 封装&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ffff00&quot; style=&quot;font-size: 18px;&quot;&gt;调用&amp;nbsp;doLoadBeanDefinitions(inputSource, encodedResource.getResource())&amp;nbsp;&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#FF0000;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-3650" y="1172.5" width="1210" height="140" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-110" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#00CCCC;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-106" target="-McDBByZdcgpEU9wJOO_-109" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#FF0000;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-106" target="swjzN8IUrycUAb-GRa1w-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-106" value="doLoadBeanDefinitions(InputSource inputSource, Resource resource)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#00cccc&quot; style=&quot;font-size: 18px;&quot;&gt;解析配置文件内容，将其属性节点内容放入 Document 对象中&amp;nbsp;Document doc = doLoadDocument(inputSource, resource)&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot; color=&quot;#ff0000&quot;&gt;创建并填充 BeanDefinition 对象&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#ff0000&quot;&gt;int count = registerBeanDefinitions(doc, resource)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-3557.5" y="1450" width="1025" height="160" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-112" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-109" target="-McDBByZdcgpEU9wJOO_-111" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-114" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FFFF00;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-109" target="-McDBByZdcgpEU9wJOO_-113" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-109" value="Document doLoadDocument(InputSource inputSource, Resource resource)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;getEntityResolver() 获取解析器(在创建&amp;nbsp;XmlBeanDefinitionReader的时候就已经赋值)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ffff00&quot; style=&quot;font-size: 18px;&quot;&gt;getValidationModeForResource 确定解析文档的格式&lt;/font&gt;&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;this.documentLoader.loadDocument(inputSource, getEntityResolver(), this.errorHandler,&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;getValidationModeForResource(resource), isNamespaceAware()) 使用 document 加载配置文集内容&lt;/span&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#00CCCC;strokeColor=#00CCCC;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-5020" y="1440" width="1110" height="180" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-111" value="&lt;div style=&quot;font-size: 18px;&quot;&gt;loadDocument(InputSource inputSource, EntityResolver entityResolver,&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;ErrorHandler errorHandler, int validationMode, boolean namespaceAware)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;DocumentBuilderFactory factory = createDocumentBuilderFactory(validationMode, namespaceAware) 创建解析 Document 工厂&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 18px;&quot;&gt;构建解析器&amp;nbsp;&lt;/span&gt;DocumentBuilder builder = createDocumentBuilder(factory, entityResolver, errorHandler)&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;使用解析器解析 Document 获取配置文档的内容节点&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#FF0000;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-4605" y="1800" width="1210" height="140" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-116" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Verdana;fontSize=18;fontColor=#FF0000;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="-McDBByZdcgpEU9wJOO_-113" target="-McDBByZdcgpEU9wJOO_-115" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-113" value="getValidationModeForResource(Resource resource)&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;int validationModeToUse = getValidationMode() 获取验证模式，在初始化 XmlBeanDefinitionReader 时已经赋值 1 自动识别&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;font-size: 18px;&quot;&gt;确定解析文档格式&amp;nbsp;int detectedMode = detectValidationMode(resource)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-5580" y="1800" width="860" height="120" as="geometry" />
        </mxCell>
        <mxCell id="-McDBByZdcgpEU9wJOO_-115" value="this.validationModeDetector.detectValidationMode(inputStream) 委派模式&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;ol style=&quot;font-size: 18px;&quot;&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;遍历读取文档内容，返回每行读内容 content = consumeCommentTokens(content)&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;判断 content 是否包含 DTD 声明的内容&amp;nbsp;hasDoctype(content) 如果是&amp;nbsp;isDtdValidated = true 文档格式为 DTD&amp;nbsp;&amp;nbsp;return (isDtdValidated ? VALIDATION_DTD : VALIDATION_XSD)&lt;/li&gt;&lt;li style=&quot;font-size: 18px;&quot;&gt;hasOpeningTag(content) 如果是 XML 则 isDtdValidated = true 则 文档格式为 XML&lt;br style=&quot;font-size: 18px;&quot;&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#FF0000;rounded=0;fontSize=18;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-5835" y="2030" width="1370" height="150" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-21" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#FFFF33;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-15" target="swjzN8IUrycUAb-GRa1w-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-15" value="registerBeanDefinitions(Document doc, Resource resource)&lt;br&gt;&lt;ol&gt;&lt;li&gt;创建&amp;nbsp;BeanDefinitionDocumentReader 对象&lt;/li&gt;&lt;li&gt;记录未填充前 beanDefinitionMap 集合的大小&amp;nbsp;&amp;nbsp;int countBefore = getRegistry().getBeanDefinitionCount()&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ffff33&quot;&gt;调用&amp;nbsp;documentReader.registerBeanDefinitions(doc, createReaderContext(resource)) 创建并填充 BeanDefinition 对象; createReaderContext(resource) 创建了一个&amp;nbsp;XmlReaderContext&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#FF0000;rounded=0;fontSize=18;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-2420" y="1461.25" width="990" height="137.5" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-17" value="AbstractBeanDefinitionReader&lt;br&gt;&lt;ol&gt;&lt;li&gt;this.registry = registry =&amp;nbsp;DefaultListableBeanFactory&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fontSize=18;align=left;fillColor=#E06D0D;strokeColor=#82b366;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-2460" y="168.75" width="470" height="107.5" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#FF0000;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-20" target="swjzN8IUrycUAb-GRa1w-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-32" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#FF00FF;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-20" target="swjzN8IUrycUAb-GRa1w-31">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-20" value="doRegisterBeanDefinitions(Element root)&lt;br&gt;&lt;ol&gt;&lt;li&gt;doRegisterBeanDefinitions(doc.getDocumentElement());&amp;nbsp; doc.getDocumentElement() 获取配置文档的标签属性&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff0000&quot;&gt;创建一个解析器，对应配置文档中的标签属性&amp;nbsp;this.delegate = createDelegate(getReaderContext(), root, parent)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;判断是否是默认的命名空间，接着判断是否包含 profile 属性，对 profile 的一些逻辑处理；&lt;/li&gt;&lt;li&gt;preProcessXml(root) 父类 DefaultBeanDefinitionDocumentReader 中没有实现该方法，留给子类扩展，可以添加 XML 标签属性；&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#ff00ff&quot;&gt;parseBeanDefinitions(root, this.delegate) 解析配置文件中的标签元素&lt;/font&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-2420" y="1690" width="990" height="350" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#FFFF00;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-24" target="swjzN8IUrycUAb-GRa1w-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-24" value="&lt;div&gt;BeanDefinitionParserDelegate createDelegate(&lt;span style=&quot;background-color: initial;&quot;&gt;XmlReaderContext readerContext, Element root, @Nullable BeanDefinitionParserDelegate parentDelegate)：&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;BeanDefinitionParserDelegate delegate = new BeanDefinitionParserDelegate(readerContext) 这个类中定义了许多标签属性&lt;br&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#ffff00&quot;&gt;initDefaults(Element root, @Nullable BeanDefinitionParserDelegate parent) 初始化默认的lazy-init、autowire、依赖检查设置、init-method、destroy-method和merge设置。如果默认值未在本地显式设置，则通过回退到给定的父级来支持嵌套的“bean”元素用例。&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FF0000;strokeColor=#FF0000;rounded=0;fontSize=18;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-1360" y="1655" width="1270" height="190" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-28" value="initDefaults(Element root, @Nullable BeanDefinitionParserDelegate parent)：&lt;br&gt;&lt;ol&gt;&lt;li&gt;populateDefaults(this.defaults, (parent != null ? parent.defaults : null), root) 使用默认的惰性初始化、自动装配、依赖性检查设置、初始化方法、销毁方法和合并设置填充给定的 DocumentDefaultsDefinition 实例&lt;br&gt;&lt;/li&gt;&lt;li&gt;fireDefaultsRegistered(DefaultsDefinition defaultsDefinition)&amp;nbsp;触发默认注册事件&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-40" y="1682.5" width="886.54" height="135" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-34" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#000000;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-31" target="swjzN8IUrycUAb-GRa1w-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-31" value="parseBeanDefinitions(Element root, BeanDefinitionParserDelegate delegate)&lt;br&gt;&lt;ol&gt;&lt;li&gt;&lt;font color=&quot;#ffffff&quot;&gt;判断标签是否是默认的命名空间，且元素是否是 Element 类，全都符合再次判断是不是标准定义的标签，是的话就按照标准定义进行解析&amp;nbsp;parseDefaultElement(ele, delegate)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;不是则按照自定义标签进行解析&amp;nbsp;delegate.parseCustomElement(ele)&amp;nbsp;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fontSize=18;align=left;fillColor=#FF00FF;strokeColor=#FF00FF;rounded=0;fontColor=#000000;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-1360" y="1920" width="1480" height="110" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#000000;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-33" target="swjzN8IUrycUAb-GRa1w-44">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-33" value="parseDefaultElement(Element ele, BeanDefinitionParserDelegate delegate)&lt;br&gt;&lt;ol&gt;&lt;li&gt;判断是否是 import 标签：importBeanDefinitionResource(ele)&lt;/li&gt;&lt;li&gt;判断是否是alias 标签：processAliasRegistration(ele)&lt;/li&gt;&lt;li&gt;&lt;font color=&quot;#0000ff&quot;&gt;判断是否是 bean 标签：processBeanDefinition(ele, delegate)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;判断是否是&amp;nbsp;beans 标签：doRegisterBeanDefinitions(ele)&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fontSize=18;align=left;fillColor=#FFFFFF;strokeColor=#000000;fontColor=#000000;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="190" y="1902.5" width="625" height="145" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;fontColor=#FF3333;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-36" target="swjzN8IUrycUAb-GRa1w-40">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-36" value="&lt;font color=&quot;#ffffff&quot;&gt;parseBeanDefinitionElement(Element ele)：&lt;/font&gt;&lt;br&gt;&lt;ol style=&quot;&quot;&gt;&lt;li style=&quot;color: rgb(255, 255, 255);&quot;&gt;获取 bean 的 id 属性；&lt;/li&gt;&lt;li style=&quot;color: rgb(255, 255, 255);&quot;&gt;获取 bean 的 name 属性&lt;/li&gt;&lt;li style=&quot;color: rgb(255, 255, 255);&quot;&gt;校验 bean 的 name 是否唯一&lt;/li&gt;&lt;li style=&quot;&quot;&gt;&lt;font color=&quot;#ffff00&quot;&gt;parseBeanDefinitionElement(ele, beanName, containingBean) 对 bean 元素进行详细解析：比如 bean 类是一个接口、抽象类等等&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fontSize=18;align=left;fillColor=#FF3333;strokeColor=#000000;fontColor=#000000;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1781" y="1839.3700000000001" width="700" height="271.25" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-40" value="&lt;div&gt;parseBeanDefinitionElement(&lt;span style=&quot;background-color: initial;&quot;&gt;Element ele, String beanName, @Nullable BeanDefinition containingBean)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;获取 class 属性&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;className = ele.getAttribute(CLASS_ATTRIBUTE).trim()&lt;br&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;获取 parent 属性&amp;nbsp;parent = ele.getAttribute(PARENT_ATTRIBUTE)&lt;/li&gt;&lt;li&gt;AbstractBeanDefinition bd = createBeanDefinition(className, parent);&amp;nbsp;&amp;nbsp;为给定的类名和父名创建一个 bean 定义 实际操作类是 GenericBeanDefinition，其实此时已经满足实例化 BeanDefinition 了。创建了GenericBeanDefinition 对象&lt;br&gt;&lt;/li&gt;&lt;li&gt;接着是对标签元素的一系列解析，以及对 GenericBeanDefinition&amp;nbsp;实现了 BeanDefinition 接口 的属性填充：比如构造函数解析、子类方法解析等&lt;/li&gt;&lt;li&gt;得到完整的 beanDeinitions 后，返回一个&amp;nbsp;new BeanDefinitionHolder(beanDefinition, beanName, aliasesArray)，该类是对 BeanDefinition 的封装。&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#FFFF00;strokeColor=#FFFF00;rounded=0;fontSize=18;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1701" y="2150" width="860" height="287.51" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=18;fontColor=#FF0000;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="swjzN8IUrycUAb-GRa1w-44" target="swjzN8IUrycUAb-GRa1w-36">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="swjzN8IUrycUAb-GRa1w-44" value="&lt;font color=&quot;#ffffff&quot;&gt;processBeanDefinition(Element ele, BeanDefinitionParserDelegate delegate)：&lt;/font&gt;&lt;br&gt;&lt;ol style=&quot;&quot;&gt;&lt;li style=&quot;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;解析标签元素得到&amp;nbsp;BeanDefinitionHolder -&amp;gt;delegate.parseBeanDefinitionElement(ele)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;" style="whiteSpace=wrap;html=1;fontSize=18;align=left;fillColor=#3333FF;strokeColor=#000000;fontColor=#000000;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="900" y="1839.38" width="789" height="271.25" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
